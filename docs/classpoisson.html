<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Saras: poisson Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Saras
   </div>
   <div id="projectbrief">Finite&nbsp;Difference&nbsp;Solver&nbsp;for&nbsp;Fluid&nbsp;Dynamics&nbsp;Simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classpoisson-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">poisson Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The base class poisson and its derived classes <a class="el" href="classmultigrid__d2.html" title="The derived class from poisson to perform multi-grid operations on a 2D grid. ">multigrid_d2</a> and <a class="el" href="classmultigrid__d3.html" title="The derived class from poisson to perform multi-grid operations on a 3D grid. ">multigrid_d3</a>.  
 <a href="classpoisson.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="poisson_8h_source.html">lib/poisson.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for poisson:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classpoisson.png" usemap="#poisson_map" alt=""/>
  <map id="poisson_map" name="poisson_map">
<area href="classmultigrid__d2.html" title="The derived class from poisson to perform multi-grid operations on a 2D grid. " alt="multigrid_d2" shape="rect" coords="0,56,80,80"/>
<area href="classmultigrid__d3.html" title="The derived class from poisson to perform multi-grid operations on a 3D grid. " alt="multigrid_d3" shape="rect" coords="90,56,170,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aab9fe3eef6a98c33bf19c2a80c46d814"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aab9fe3eef6a98c33bf19c2a80c46d814">poisson</a> (const <a class="el" href="classgrid.html">grid</a> &amp;mesh, const <a class="el" href="classparser.html">parser</a> &amp;solParam)</td></tr>
<tr class="memdesc:aab9fe3eef6a98c33bf19c2a80c46d814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor of the base poisson class.  <a href="#aab9fe3eef6a98c33bf19c2a80c46d814">More...</a><br /></td></tr>
<tr class="separator:aab9fe3eef6a98c33bf19c2a80c46d814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963e726526e6a6fdcb16c188eda79fb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a963e726526e6a6fdcb16c188eda79fb5">mgSolve</a> (<a class="el" href="classplainsf.html">plainsf</a> &amp;inFn, const <a class="el" href="classplainsf.html">plainsf</a> &amp;rhs)</td></tr>
<tr class="memdesc:a963e726526e6a6fdcb16c188eda79fb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The core, publicly accessible function of poisson to compute the solution for the Poisson equation.  <a href="#a963e726526e6a6fdcb16c188eda79fb5">More...</a><br /></td></tr>
<tr class="separator:a963e726526e6a6fdcb16c188eda79fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aba6da6b984daa318c096856a89aad5"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a5aba6da6b984daa318c096856a89aad5">testProlong</a> ()</td></tr>
<tr class="memdesc:a5aba6da6b984daa318c096856a89aad5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to test whether prolongation operations are interpolating correctly.  <a href="#a5aba6da6b984daa318c096856a89aad5">More...</a><br /></td></tr>
<tr class="separator:a5aba6da6b984daa318c096856a89aad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b6d857339e8e32b19e984f256439cad"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a9b6d857339e8e32b19e984f256439cad">testTransfer</a> ()</td></tr>
<tr class="memdesc:a9b6d857339e8e32b19e984f256439cad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to test whether strided data transfer is performing as expected.  <a href="#a9b6d857339e8e32b19e984f256439cad">More...</a><br /></td></tr>
<tr class="separator:a9b6d857339e8e32b19e984f256439cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2855b369562564e37b1174950a4ebfae"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a2855b369562564e37b1174950a4ebfae">testPeriodic</a> ()</td></tr>
<tr class="memdesc:a2855b369562564e37b1174950a4ebfae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to test whether periodic BC is being implemented properly.  <a href="#a2855b369562564e37b1174950a4ebfae">More...</a><br /></td></tr>
<tr class="separator:a2855b369562564e37b1174950a4ebfae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a2d6c2c4b88ee54fc4be0a31e13708d70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a2d6c2c4b88ee54fc4be0a31e13708d70">setLocalSizeIndex</a> ()</td></tr>
<tr class="memdesc:a2d6c2c4b88ee54fc4be0a31e13708d70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the local size indices of sub-domains after MPI domain decomposition.  <a href="#a2d6c2c4b88ee54fc4be0a31e13708d70">More...</a><br /></td></tr>
<tr class="separator:a2d6c2c4b88ee54fc4be0a31e13708d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70beec7a8da06e90144e86818d5ef65a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a70beec7a8da06e90144e86818d5ef65a">initializeArrays</a> ()</td></tr>
<tr class="memdesc:a70beec7a8da06e90144e86818d5ef65a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to initialize the arrays used in multi-grid.  <a href="#a70beec7a8da06e90144e86818d5ef65a">More...</a><br /></td></tr>
<tr class="separator:a70beec7a8da06e90144e86818d5ef65a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660a034c820a8cf17252732312b3913c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a660a034c820a8cf17252732312b3913c">copyStaggrDerivs</a> ()</td></tr>
<tr class="memdesc:a660a034c820a8cf17252732312b3913c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to copy the staggered grid derivatives from the grid class to local arrays.  <a href="#a660a034c820a8cf17252732312b3913c">More...</a><br /></td></tr>
<tr class="separator:a660a034c820a8cf17252732312b3913c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a34d851780fdbd0f97dca6555f80c02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a6a34d851780fdbd0f97dca6555f80c02">setCoefficients</a> ()</td></tr>
<tr class="memdesc:a6a34d851780fdbd0f97dca6555f80c02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the coefficients used for calculating laplacian and in smoothing.  <a href="#a6a34d851780fdbd0f97dca6555f80c02">More...</a><br /></td></tr>
<tr class="separator:a6a34d851780fdbd0f97dca6555f80c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9934adb3c6cb63d1f133ae0aed871d63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a9934adb3c6cb63d1f133ae0aed871d63">setStagBounds</a> ()</td></tr>
<tr class="memdesc:a9934adb3c6cb63d1f133ae0aed871d63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the RectDomain variables for all future references throughout the poisson solver.  <a href="#a9934adb3c6cb63d1f133ae0aed871d63">More...</a><br /></td></tr>
<tr class="separator:a9934adb3c6cb63d1f133ae0aed871d63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ed02c4dc5f1a304d287f5d0481cbe22"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a5ed02c4dc5f1a304d287f5d0481cbe22">coarsen</a> ()</td></tr>
<tr class="memdesc:a5ed02c4dc5f1a304d287f5d0481cbe22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to coarsen the grid down the levels of the V-Cycle.  <a href="#a5ed02c4dc5f1a304d287f5d0481cbe22">More...</a><br /></td></tr>
<tr class="separator:a5ed02c4dc5f1a304d287f5d0481cbe22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0ade4f081b9aa098737191193c8f99e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aa0ade4f081b9aa098737191193c8f99e">prolong</a> ()</td></tr>
<tr class="memdesc:aa0ade4f081b9aa098737191193c8f99e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform prolongation on the array being solved.  <a href="#aa0ade4f081b9aa098737191193c8f99e">More...</a><br /></td></tr>
<tr class="separator:aa0ade4f081b9aa098737191193c8f99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a776a03c75c2472a40818026af963d46f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a776a03c75c2472a40818026af963d46f">computeResidual</a> ()</td></tr>
<tr class="memdesc:a776a03c75c2472a40818026af963d46f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compute the residual at the start of each V-Cycle.  <a href="#a776a03c75c2472a40818026af963d46f">More...</a><br /></td></tr>
<tr class="separator:a776a03c75c2472a40818026af963d46f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34dcab564048f46bfe636709bd765c39"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a34dcab564048f46bfe636709bd765c39">smooth</a> (const int smoothCount)</td></tr>
<tr class="memdesc:a34dcab564048f46bfe636709bd765c39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform smoothing operation on the input array.  <a href="#a34dcab564048f46bfe636709bd765c39">More...</a><br /></td></tr>
<tr class="separator:a34dcab564048f46bfe636709bd765c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28f2f901d0d7e2af97f23807a8d3650"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#ae28f2f901d0d7e2af97f23807a8d3650">computeError</a> (const int normOrder)</td></tr>
<tr class="memdesc:ae28f2f901d0d7e2af97f23807a8d3650"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compute the error at the end of each V-Cycle.  <a href="#ae28f2f901d0d7e2af97f23807a8d3650">More...</a><br /></td></tr>
<tr class="separator:ae28f2f901d0d7e2af97f23807a8d3650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c17460de3df67f81b3399a916f03dba"><td class="memItemLeft" align="right" valign="top"><a id="a2c17460de3df67f81b3399a916f03dba"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>solve</b> ()</td></tr>
<tr class="separator:a2c17460de3df67f81b3399a916f03dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a490f97075d967bfbe5c692fdea48f719"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a490f97075d967bfbe5c692fdea48f719">imposeBC</a> ()</td></tr>
<tr class="memdesc:a490f97075d967bfbe5c692fdea48f719"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to impose the boundary conditions of Poisson solver at different levels of the V-cycle.  <a href="#a490f97075d967bfbe5c692fdea48f719">More...</a><br /></td></tr>
<tr class="separator:a490f97075d967bfbe5c692fdea48f719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa95b6928a8652c3861245399da6143c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aaa95b6928a8652c3861245399da6143c">createMGSubArrays</a> ()</td></tr>
<tr class="memdesc:aaa95b6928a8652c3861245399da6143c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to create the MPI sub-array data types necessary to transfer data across sub-domains.  <a href="#aaa95b6928a8652c3861245399da6143c">More...</a><br /></td></tr>
<tr class="separator:aaa95b6928a8652c3861245399da6143c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74bd2a7bc20487c579569788c1df709"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#ac74bd2a7bc20487c579569788c1df709">updatePads</a> (blitz::Array&lt; blitz::Array&lt; real, 3 &gt;, 1 &gt; &amp;data)</td></tr>
<tr class="memdesc:ac74bd2a7bc20487c579569788c1df709"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to update the pad points of the local sub-domains at different levels of the V-cycle.  <a href="#ac74bd2a7bc20487c579569788c1df709">More...</a><br /></td></tr>
<tr class="separator:ac74bd2a7bc20487c579569788c1df709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a4d7b1cd67bc69df92f9bcf3e3901e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aa6a4d7b1cd67bc69df92f9bcf3e3901e">vCycle</a> ()</td></tr>
<tr class="memdesc:aa6a4d7b1cd67bc69df92f9bcf3e3901e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform one loop of V-cycle.  <a href="#aa6a4d7b1cd67bc69df92f9bcf3e3901e">More...</a><br /></td></tr>
<tr class="separator:aa6a4d7b1cd67bc69df92f9bcf3e3901e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a20e525cc41ffa918e78eb34a9c395e0d"><td class="memItemLeft" align="right" valign="top"><a id="a20e525cc41ffa918e78eb34a9c395e0d"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>isOdd</b> (int x)</td></tr>
<tr class="separator:a20e525cc41ffa918e78eb34a9c395e0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aee2daa777d57f65ef717183a4c40bead"><td class="memItemLeft" align="right" valign="top"><a id="aee2daa777d57f65ef717183a4c40bead"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>vLevel</b></td></tr>
<tr class="separator:aee2daa777d57f65ef717183a4c40bead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49a892f57c3b5f7ea99a9723181d1a06"><td class="memItemLeft" align="right" valign="top"><a id="a49a892f57c3b5f7ea99a9723181d1a06"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>maxCount</b></td></tr>
<tr class="separator:a49a892f57c3b5f7ea99a9723181d1a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefd0c2dd1f9271ccf3a3ad1ff8b790e0"><td class="memItemLeft" align="right" valign="top"><a id="aefd0c2dd1f9271ccf3a3ad1ff8b790e0"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>zeroBC</b></td></tr>
<tr class="separator:aefd0c2dd1f9271ccf3a3ad1ff8b790e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d97d0883e72d984c1a38a9a0829303"><td class="memItemLeft" align="right" valign="top"><a id="ab1d97d0883e72d984c1a38a9a0829303"></a>
const <a class="el" href="classgrid.html">grid</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>mesh</b></td></tr>
<tr class="separator:ab1d97d0883e72d984c1a38a9a0829303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87b63589cf01cef8f578a2d5d879a41b"><td class="memItemLeft" align="right" valign="top"><a id="a87b63589cf01cef8f578a2d5d879a41b"></a>
const <a class="el" href="classparser.html">parser</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>inputParams</b></td></tr>
<tr class="separator:a87b63589cf01cef8f578a2d5d879a41b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a688b1b05dbe30a3a513a5d7c61ba2ed1"><td class="memItemLeft" align="right" valign="top"><a id="a688b1b05dbe30a3a513a5d7c61ba2ed1"></a>
blitz::Range&#160;</td><td class="memItemRight" valign="bottom"><b>all</b></td></tr>
<tr class="separator:a688b1b05dbe30a3a513a5d7c61ba2ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab644084739368907c152e69501676832"><td class="memItemLeft" align="right" valign="top"><a id="ab644084739368907c152e69501676832"></a>
blitz::Array&lt; blitz::Array&lt; real, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>pressureData</b></td></tr>
<tr class="separator:ab644084739368907c152e69501676832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf99a12358110298ae7e2105aa620f35"><td class="memItemLeft" align="right" valign="top"><a id="aaf99a12358110298ae7e2105aa620f35"></a>
blitz::Array&lt; blitz::Array&lt; real, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>residualData</b></td></tr>
<tr class="separator:aaf99a12358110298ae7e2105aa620f35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a37df89535a91b3206f9665228c026"><td class="memItemLeft" align="right" valign="top"><a id="ad8a37df89535a91b3206f9665228c026"></a>
blitz::Array&lt; blitz::Array&lt; real, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>tmpDataArray</b></td></tr>
<tr class="separator:ad8a37df89535a91b3206f9665228c026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6edebc973bfcde2111c38e59ff4ca40e"><td class="memItemLeft" align="right" valign="top"><a id="a6edebc973bfcde2111c38e59ff4ca40e"></a>
blitz::Array&lt; blitz::Array&lt; real, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>smoothedPres</b></td></tr>
<tr class="separator:a6edebc973bfcde2111c38e59ff4ca40e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade65668d7e30a32562137e7ff3be378c"><td class="memItemLeft" align="right" valign="top"><a id="ade65668d7e30a32562137e7ff3be378c"></a>
blitz::Array&lt; blitz::RectDomain&lt; 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>stagFull</b></td></tr>
<tr class="separator:ade65668d7e30a32562137e7ff3be378c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1502cc1b4a28490d0996380ac001a78"><td class="memItemLeft" align="right" valign="top"><a id="ae1502cc1b4a28490d0996380ac001a78"></a>
blitz::Array&lt; blitz::RectDomain&lt; 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>stagCore</b></td></tr>
<tr class="separator:ae1502cc1b4a28490d0996380ac001a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e5bfe933dc16cfb7cd6fe3538cf68c"><td class="memItemLeft" align="right" valign="top"><a id="a66e5bfe933dc16cfb7cd6fe3538cf68c"></a>
blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xEnd</b></td></tr>
<tr class="separator:a66e5bfe933dc16cfb7cd6fe3538cf68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae59b38eab117002a759699568d9fef4c"><td class="memItemLeft" align="right" valign="top"><a id="ae59b38eab117002a759699568d9fef4c"></a>
blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>yEnd</b></td></tr>
<tr class="separator:ae59b38eab117002a759699568d9fef4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d1b043de3428d7f451973665d56f0e9"><td class="memItemLeft" align="right" valign="top"><a id="a8d1b043de3428d7f451973665d56f0e9"></a>
blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>zEnd</b></td></tr>
<tr class="separator:a8d1b043de3428d7f451973665d56f0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a953512971631f7945817364aec8efb9a"><td class="memItemLeft" align="right" valign="top"><a id="a953512971631f7945817364aec8efb9a"></a>
blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSizeArray</b></td></tr>
<tr class="separator:a953512971631f7945817364aec8efb9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ae1b3a54edc3f3b600456f2836f101"><td class="memItemLeft" align="right" valign="top"><a id="a67ae1b3a54edc3f3b600456f2836f101"></a>
blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>strideValues</b></td></tr>
<tr class="separator:a67ae1b3a54edc3f3b600456f2836f101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7c90e99131837dc63489c163772c7e"><td class="memItemLeft" align="right" valign="top"><a id="a9c7c90e99131837dc63489c163772c7e"></a>
blitz::TinyVector&lt; int, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>localSizeIndex</b></td></tr>
<tr class="separator:a9c7c90e99131837dc63489c163772c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24743bcf66b813d01c1bafab94932102"><td class="memItemLeft" align="right" valign="top"><a id="a24743bcf66b813d01c1bafab94932102"></a>
blitz::Array&lt; MPI_Request, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>recvRequest</b></td></tr>
<tr class="separator:a24743bcf66b813d01c1bafab94932102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3ad34ac614138d80203d90d2e7b680"><td class="memItemLeft" align="right" valign="top"><a id="a7f3ad34ac614138d80203d90d2e7b680"></a>
blitz::Array&lt; MPI_Status, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>recvStatus</b></td></tr>
<tr class="separator:a7f3ad34ac614138d80203d90d2e7b680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8104b042af89b49027614909803d1c39"><td class="memItemLeft" align="right" valign="top"><a id="a8104b042af89b49027614909803d1c39"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hx</b></td></tr>
<tr class="separator:a8104b042af89b49027614909803d1c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52cfc1bfff84b163e7966773d7e1286e"><td class="memItemLeft" align="right" valign="top"><a id="a52cfc1bfff84b163e7966773d7e1286e"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hy</b></td></tr>
<tr class="separator:a52cfc1bfff84b163e7966773d7e1286e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad56e000c82520b5a53171f594a945aa8"><td class="memItemLeft" align="right" valign="top"><a id="ad56e000c82520b5a53171f594a945aa8"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hz</b></td></tr>
<tr class="separator:ad56e000c82520b5a53171f594a945aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad200d109efac85d61b8065ee1745bfc9"><td class="memItemLeft" align="right" valign="top"><a id="ad200d109efac85d61b8065ee1745bfc9"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hx2</b></td></tr>
<tr class="separator:ad200d109efac85d61b8065ee1745bfc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4029fee602ce517e19d143f39d1e07c2"><td class="memItemLeft" align="right" valign="top"><a id="a4029fee602ce517e19d143f39d1e07c2"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hz2</b></td></tr>
<tr class="separator:a4029fee602ce517e19d143f39d1e07c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ca8782c430ec1f8d4722754d95beaf"><td class="memItemLeft" align="right" valign="top"><a id="a82ca8782c430ec1f8d4722754d95beaf"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hzhx</b></td></tr>
<tr class="separator:a82ca8782c430ec1f8d4722754d95beaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade7d7f0aa02703a6bec5dcdd9b84adf7"><td class="memItemLeft" align="right" valign="top"><a id="ade7d7f0aa02703a6bec5dcdd9b84adf7"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hxhy</b></td></tr>
<tr class="separator:ade7d7f0aa02703a6bec5dcdd9b84adf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb897798c2048f6768d6e86e3d1f0d1b"><td class="memItemLeft" align="right" valign="top"><a id="abb897798c2048f6768d6e86e3d1f0d1b"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hyhz</b></td></tr>
<tr class="separator:abb897798c2048f6768d6e86e3d1f0d1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee537915fa380dce5ddd84ac197169ad"><td class="memItemLeft" align="right" valign="top"><a id="aee537915fa380dce5ddd84ac197169ad"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hxhyhz</b></td></tr>
<tr class="separator:aee537915fa380dce5ddd84ac197169ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac48cfb4bfc9b6636957eeb0ae306d79"><td class="memItemLeft" align="right" valign="top"><a id="aac48cfb4bfc9b6636957eeb0ae306d79"></a>
blitz::Array&lt; blitz::Array&lt; real, 1 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xixx</b></td></tr>
<tr class="separator:aac48cfb4bfc9b6636957eeb0ae306d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5f7cef09f2aa38529ad1ff9b563285d"><td class="memItemLeft" align="right" valign="top"><a id="ab5f7cef09f2aa38529ad1ff9b563285d"></a>
blitz::Array&lt; blitz::Array&lt; real, 1 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xix2</b></td></tr>
<tr class="separator:ab5f7cef09f2aa38529ad1ff9b563285d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2527a8b0f584ff1a3bae034ed601a2"><td class="memItemLeft" align="right" valign="top"><a id="a0a2527a8b0f584ff1a3bae034ed601a2"></a>
blitz::Array&lt; blitz::Array&lt; real, 1 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>etyy</b></td></tr>
<tr class="separator:a0a2527a8b0f584ff1a3bae034ed601a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9374feacd34ee412e8450d088f6f7ed"><td class="memItemLeft" align="right" valign="top"><a id="ab9374feacd34ee412e8450d088f6f7ed"></a>
blitz::Array&lt; blitz::Array&lt; real, 1 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ety2</b></td></tr>
<tr class="separator:ab9374feacd34ee412e8450d088f6f7ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e11f46238d57582db354877b576309"><td class="memItemLeft" align="right" valign="top"><a id="a65e11f46238d57582db354877b576309"></a>
blitz::Array&lt; blitz::Array&lt; real, 1 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ztzz</b></td></tr>
<tr class="separator:a65e11f46238d57582db354877b576309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1aea120120dd81c60285c9cd3a5007d"><td class="memItemLeft" align="right" valign="top"><a id="ac1aea120120dd81c60285c9cd3a5007d"></a>
blitz::Array&lt; blitz::Array&lt; real, 1 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ztz2</b></td></tr>
<tr class="separator:ac1aea120120dd81c60285c9cd3a5007d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef047da5a4165559faeaa91f30a1a4df"><td class="memItemLeft" align="right" valign="top"><a id="aef047da5a4165559faeaa91f30a1a4df"></a>
blitz::Array&lt; MPI_Datatype, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xMGArray</b></td></tr>
<tr class="separator:aef047da5a4165559faeaa91f30a1a4df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbc84a897a9f6e66f06eefaad3362270"><td class="memItemLeft" align="right" valign="top"><a id="adbc84a897a9f6e66f06eefaad3362270"></a>
blitz::Array&lt; MPI_Datatype, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>yMGArray</b></td></tr>
<tr class="separator:adbc84a897a9f6e66f06eefaad3362270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f2882fa3a67d6e3a961802e65e9622c"><td class="memItemLeft" align="right" valign="top"><a id="a5f2882fa3a67d6e3a961802e65e9622c"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendLft</b></td></tr>
<tr class="separator:a5f2882fa3a67d6e3a961802e65e9622c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894eefe7eec2dd250456615f7073055e"><td class="memItemLeft" align="right" valign="top"><a id="a894eefe7eec2dd250456615f7073055e"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendRgt</b></td></tr>
<tr class="separator:a894eefe7eec2dd250456615f7073055e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4134c53a43a79b523ac8c5ca0b4cc054"><td class="memItemLeft" align="right" valign="top"><a id="a4134c53a43a79b523ac8c5ca0b4cc054"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvLft</b></td></tr>
<tr class="separator:a4134c53a43a79b523ac8c5ca0b4cc054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe9f9948a665cb292c7e71356cee803"><td class="memItemLeft" align="right" valign="top"><a id="a2fe9f9948a665cb292c7e71356cee803"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvRgt</b></td></tr>
<tr class="separator:a2fe9f9948a665cb292c7e71356cee803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecbed9b004ec7e8414714bed0ca1990"><td class="memItemLeft" align="right" valign="top"><a id="a4ecbed9b004ec7e8414714bed0ca1990"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendFrn</b></td></tr>
<tr class="separator:a4ecbed9b004ec7e8414714bed0ca1990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de302e77559db37dae4539fad76d4f8"><td class="memItemLeft" align="right" valign="top"><a id="a3de302e77559db37dae4539fad76d4f8"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendBak</b></td></tr>
<tr class="separator:a3de302e77559db37dae4539fad76d4f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa911270ff4db4eb9487375abe5490219"><td class="memItemLeft" align="right" valign="top"><a id="aa911270ff4db4eb9487375abe5490219"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvFrn</b></td></tr>
<tr class="separator:aa911270ff4db4eb9487375abe5490219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317a4e844d4e0e62b5ef877f082c28d5"><td class="memItemLeft" align="right" valign="top"><a id="a317a4e844d4e0e62b5ef877f082c28d5"></a>
blitz::Array&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvBak</b></td></tr>
<tr class="separator:a317a4e844d4e0e62b5ef877f082c28d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The base class poisson and its derived classes <a class="el" href="classmultigrid__d2.html" title="The derived class from poisson to perform multi-grid operations on a 2D grid. ">multigrid_d2</a> and <a class="el" href="classmultigrid__d3.html" title="The derived class from poisson to perform multi-grid operations on a 3D grid. ">multigrid_d3</a>. </p>
<p>The class implements the geometric multi-grid method for solving the Poisson equation on a non-uniform grid across MPI decomposed domains for parallel computations. The data structure used by the class for computing multi-grid V-cycles across sub-domains is a blitz array with very wide overlap. When calculating the finite differences at the sub-domain boundaries, at the coarsest level of the V-cycle, data points from very deep within the neighbouring sub-domains are necessary. This is the reason for using a wide pad, that spans up to the nearest node of the adjacent sub-domain at the coarsest mesh. This increases the memory footprint, but doesn't increase the computational time as only a single finite-difference calculation is being done using the pads at all levels of the V-cycle.</p>
<p>All the necessary functions to perform the V-cycle - prolongation, solving at coarsest mesh, smoothening, etc. are implemented within the <a class="el" href="classpoisson.html">poisson</a> class. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aab9fe3eef6a98c33bf19c2a80c46d814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab9fe3eef6a98c33bf19c2a80c46d814">&#9670;&nbsp;</a></span>poisson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">poisson::poisson </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgrid.html">grid</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classparser.html">parser</a> &amp;&#160;</td>
          <td class="paramname"><em>solParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor of the base poisson class. </p>
<p>The short base constructor of the poisson class merely assigns the const references to the grid and parser class instances being used in the solver. Moreover, it resizes and populates a local array of multi-grid sizes as used in the grid class. An array of strides to be used at different V-cycle levels is also generated and stored. Finally, the maximum allowable number of iterations for the Jacobi iterative solver being used at the coarsest mesh is set as \( N_{max} = N_x \times N_y \times N_z \), where \(N_x\), \(N_y\) and \(N_z\) are the number of grid points in the collocated grid at the local sub-domains along x, y and z directions respectively.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>is a const reference to the global data contained in the grid class </td></tr>
    <tr><td class="paramname">solParam</td><td>is a const reference to the user-set parameters contained in the parser class </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5ed02c4dc5f1a304d287f5d0481cbe22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ed02c4dc5f1a304d287f5d0481cbe22">&#9670;&nbsp;</a></span>coarsen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::coarsen </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to coarsen the grid down the levels of the V-Cycle. </p>
<p>Coarsening reduces the number of points in the grid by averaging values at two adjacent nodes onto an intermediate point between them As a result, the number of points in the domain decreases from \( 2^{N+1} + 1 \) at the input level to \( 2^N + 1 \). The vLevel variable is accordingly incremented by 1 to reflect this descent by one step down the V-Cycle. </p>

</div>
</div>
<a id="ae28f2f901d0d7e2af97f23807a8d3650"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28f2f901d0d7e2af97f23807a8d3650">&#9670;&nbsp;</a></span>computeError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::computeError </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>normOrder</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compute the error at the end of each V-Cycle. </p>
<p>To check for convergence, the residual must be computed throughout the domain. This function offers multiple ways to compute the residual (global maximum, rms, mean, etc.)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">normOrder</td><td>is the integer value of the order of norm used to calculate the residual. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a776a03c75c2472a40818026af963d46f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776a03c75c2472a40818026af963d46f">&#9670;&nbsp;</a></span>computeResidual()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::computeResidual </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compute the residual at the start of each V-Cycle. </p>
<p>The Poisson solver solves for the residual r = b - Ax This function computes this residual by calculating the Laplacian of the pressure field and subtracting it from the RHS of Poisson equation. </p>

</div>
</div>
<a id="a660a034c820a8cf17252732312b3913c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660a034c820a8cf17252732312b3913c">&#9670;&nbsp;</a></span>copyStaggrDerivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::copyStaggrDerivs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to copy the staggered grid derivatives from the grid class to local arrays. </p>
<p>Though the grid derivatives in the grid class can be read and accessed, they cannot be used directly along with the arrays defined in the poisson class as the local arrays have wide pads on both sides. Therefore, correspondingly wide arrays for grid derivatives are used, into which the staggered grid derivatives from the grid class are written and stored. This function serves this purpose of copying the grid derivatives. </p>

</div>
</div>
<a id="aaa95b6928a8652c3861245399da6143c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa95b6928a8652c3861245399da6143c">&#9670;&nbsp;</a></span>createMGSubArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::createMGSubArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to create the MPI sub-array data types necessary to transfer data across sub-domains. </p>
<p>The inter-domain boundaries of all the sub-domains at different V-cycle levels need data to be transfered at with different mesh strides. The number of sub-arrays along each edge/face of the sub-domains are equal to the number of V-cycle levels. Since this data transfer has to take place at all the mesh levels including the finest mesh, there will be vcDepth + 1 elements. </p>

</div>
</div>
<a id="a490f97075d967bfbe5c692fdea48f719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a490f97075d967bfbe5c692fdea48f719">&#9670;&nbsp;</a></span>imposeBC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::imposeBC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to impose the boundary conditions of Poisson solver at different levels of the V-cycle. </p>
<p>This function is called mainly during smoothing operations to impose the boundary conditions for the Poisson equation. The sub-domains close to the wall will have the Neumann boundary condition on pressure imposeed at the walls. Meanwhile at the interior boundaries at the inter-processor sub-domains, data is transferred from the neighbouring cells by calling the <a class="el" href="classpoisson.html#ac74bd2a7bc20487c579569788c1df709">updatePads</a> function. </p>

</div>
</div>
<a id="a70beec7a8da06e90144e86818d5ef65a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70beec7a8da06e90144e86818d5ef65a">&#9670;&nbsp;</a></span>initializeArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::initializeArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to initialize the arrays used in multi-grid. </p>
<p>The memory required for various arrays in multi-grid solver are pre-allocated through this function. The function is called from within the constructor to perform this allocation once and for all. The arrays are initialized to 0. </p>

</div>
</div>
<a id="a963e726526e6a6fdcb16c188eda79fb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a963e726526e6a6fdcb16c188eda79fb5">&#9670;&nbsp;</a></span>mgSolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::mgSolve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classplainsf.html">plainsf</a> &amp;&#160;</td>
          <td class="paramname"><em>inFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classplainsf.html">plainsf</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The core, publicly accessible function of poisson to compute the solution for the Poisson equation. </p>
<p>The function calls the V-cycle as many times as set by the user. Before doing so, the input data is transferred into the data-structures used by the poisson class to perform restrictions and prolongations without copying. Finally, the computed solution is transferred back from the internal data-structures back into the scalar field supplied by the calling function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inFn</td><td>is a pointer to the plain scalar field (cell-centered) into which the computed soltuion must be transferred </td></tr>
    <tr><td class="paramname">rhs</td><td>is a const reference to the plain scalar field (cell-centered) which contains the RHS for the Poisson equation to solve </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa0ade4f081b9aa098737191193c8f99e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0ade4f081b9aa098737191193c8f99e">&#9670;&nbsp;</a></span>prolong()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::prolong </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to perform prolongation on the array being solved. </p>
<p>Prolongation makes the grid finer by averaging values at two adjacent nodes onto an intermediate point between them As a result, the number of points in the domain increases from \( 2^N + 1 \) at the input level to \( 2^{N+1} + 1 \). The vLevel variable is accordingly reduced by 1 to reflect this ascent by one step up the V-Cycle. </p>

</div>
</div>
<a id="a6a34d851780fdbd0f97dca6555f80c02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a34d851780fdbd0f97dca6555f80c02">&#9670;&nbsp;</a></span>setCoefficients()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::setCoefficients </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to set the coefficients used for calculating laplacian and in smoothing. </p>
<p>The function assigns values to the variables hx, hy etc. These coefficients are repeatedly used at many places in the Poisson solver. </p>

</div>
</div>
<a id="a2d6c2c4b88ee54fc4be0a31e13708d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d6c2c4b88ee54fc4be0a31e13708d70">&#9670;&nbsp;</a></span>setLocalSizeIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::setLocalSizeIndex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to calculate the local size indices of sub-domains after MPI domain decomposition. </p>
<p>For the multi-grid solver, the number of grid nodes must be \( 2^N + 1 \) to perform V-Cycles The domain decomposition is also done in such a way that each sub-domain will also have \( 2^M + 1 \) points. As a result, the number of processors in each direction must be a power of 2. In this case, the the value \( M \) of \( 2^M + 1 \) can be computed as \( M = N - log_2(np) \) where \( np \) is the number of processors along the direction under consideration. </p>

</div>
</div>
<a id="a9934adb3c6cb63d1f133ae0aed871d63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9934adb3c6cb63d1f133ae0aed871d63">&#9670;&nbsp;</a></span>setStagBounds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::setStagBounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to set the RectDomain variables for all future references throughout the poisson solver. </p>
<p>The function sets the core and full domain staggered grid sizes for all the sub-domains. </p>

</div>
</div>
<a id="a34dcab564048f46bfe636709bd765c39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34dcab564048f46bfe636709bd765c39">&#9670;&nbsp;</a></span>smooth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::smooth </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>smoothCount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to perform smoothing operation on the input array. </p>
<p>The smoothing operation is always performed on the data contained in the array pressureData. The array tmpDataArray is used to store the temporary data and it is continuously swapped with the pressureData array at every iteration. This operation can be performed at any level of the V-cycle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">smoothCount</td><td>is the integer value of the number of smoothing iterations to be performed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2855b369562564e37b1174950a4ebfae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2855b369562564e37b1174950a4ebfae">&#9670;&nbsp;</a></span>testPeriodic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::testPeriodic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to test whether periodic BC is being implemented properly. </p>
<p>The function populates the arrays with predetermined values at all locations. It then calls imposeBC function at different vLevels and checks if the correct values of the functions are imposed at boundaries This done by printing the contents of the arrays for visual inspection for now. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#afc3eb5df1502f7c55f8d716dbec070cc">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a36d39d10145268fd551280d870b6b7a1">multigrid_d2</a>.</p>

</div>
</div>
<a id="a5aba6da6b984daa318c096856a89aad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aba6da6b984daa318c096856a89aad5">&#9670;&nbsp;</a></span>testProlong()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::testProlong </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to test whether prolongation operations are interpolating correctly. </p>
<p>The function populates the arrays with predetermined values at all locations. It then calls prolong function at a lower vLevel and checks if the data is being interpolated correctly at higher vLevel This done by returning the average deviation from correct values as a real value </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a84b56f2d55c0c26ea2f2beee363e3520">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#af50893d991beceb3762cc22c6b48d980">multigrid_d2</a>.</p>

</div>
</div>
<a id="a9b6d857339e8e32b19e984f256439cad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b6d857339e8e32b19e984f256439cad">&#9670;&nbsp;</a></span>testTransfer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::testTransfer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to test whether strided data transfer is performing as expected. </p>
<p>The function populates the arrays with predetermined values at all locations. It then calls updatePads at different vLevels and checks is the data is being transferred along x and y directions This done by printing the contents of the arrays for visual inspection for now. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#af0622319df641d434ca81b589ea7a489">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a039726d6912b47042565d4a2b3d33ab9">multigrid_d2</a>.</p>

</div>
</div>
<a id="ac74bd2a7bc20487c579569788c1df709"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac74bd2a7bc20487c579569788c1df709">&#9670;&nbsp;</a></span>updatePads()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::updatePads </td>
          <td>(</td>
          <td class="paramtype">blitz::Array&lt; blitz::Array&lt; real, 3 &gt;, 1 &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to update the pad points of the local sub-domains at different levels of the V-cycle. </p>
<p>This function is called mainly during smoothing operations by the <a class="el" href="classpoisson.html#a490f97075d967bfbe5c692fdea48f719">imposeBC</a> function. At the interior boundaries at the inter-processor sub-domains, data is transferred from the neighbouring cells using a combination of MPI_Irecv and MPI_Send functions. </p>

</div>
</div>
<a id="aa6a4d7b1cd67bc69df92f9bcf3e3901e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6a4d7b1cd67bc69df92f9bcf3e3901e">&#9670;&nbsp;</a></span>vCycle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::vCycle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to perform one loop of V-cycle. </p>
<p>The V-cycle of restrictions, prolongations and smoothings are performed within this function. First the input data contained in pressureData is smoothed, after which the residual is computed and stored in the residualData array. The restrictions, smoothing, and prolongations are performed on these two arrays subsequently. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lib/poisson/<a class="el" href="poisson_8h_source.html">poisson.h</a></li>
<li>lib/poisson/<a class="el" href="poisson_8cc.html">poisson.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 29 2021 16:27:59 for Saras by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
